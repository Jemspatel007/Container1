options:
  logging: CLOUD_LOGGING_ONLY

steps:
  # Docker Build
  - id: Build
    name: "gcr.io/cloud-builders/docker"
    entrypoint: "bash"
    args: [
      "-c",
      "echo 'Step 2: Building Docker image...'; \
      us-central1-docker.pkg.dev/cloud-428821/k8-jems; \
      docker build -t us-central1-docker.pkg.dev/${PROJECT_ID}/k8-jems/k8s-container1:${SHORT_SHA} \
                   -t us-central1-docker.pkg.dev/${PROJECT_ID}/k8-jems/k8s-container1:latest .; \
      echo 'Docker image built successfully.'"
    ]

  # Docker Push
  - id: Push
    name: "gcr.io/cloud-builders/docker"
    entrypoint: "bash"
    args: [
      "-c",
      "echo 'Step 3: Pushing Docker image...'; \
      docker push --all-tags us-central1-docker.pkg.dev/${PROJECT_ID}/k8-jems/k8s-container1; \
      echo 'Image pushed successfully.'"
    ]
